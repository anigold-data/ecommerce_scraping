2025-05-20 18:52:38,305 - ETL - INFO - No database connection provided, will establish when needed
2025-05-20 18:52:38,306 - ETL - INFO - Establishing database connection
2025-05-20 18:52:38,307 - Database - ERROR - Error connecting to database: unable to open database file
2025-05-20 18:52:38,308 - Database - ERROR - Error inserting product: 'NoneType' object has no attribute 'cursor'
2025-05-20 18:52:38,308 - ETL - ERROR - Error loading data to database: 'NoneType' object has no attribute 'rollback'
2025-05-20 18:52:38,312 - ETL - ERROR - Traceback (most recent call last):
  File "C:\Users\adeda\onedrive\desktop\ecommerce_scraping\database.py", line 107, in insert_product
    cursor = conn.cursor()
             ^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'cursor'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\adeda\onedrive\desktop\ecommerce_scraping\etl.py", line 233, in load_to_database
    product_id = insert_product(conn, product_data)
  File "C:\Users\adeda\onedrive\desktop\ecommerce_scraping\database.py", line 159, in insert_product
    conn.rollback()
    ^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'rollback'

2025-05-20 18:52:38,313 - ETL - INFO - Establishing database connection
2025-05-20 18:52:38,314 - Database - ERROR - Error connecting to database: unable to open database file
2025-05-20 18:52:38,314 - Database - ERROR - Error inserting product: 'NoneType' object has no attribute 'cursor'
2025-05-20 18:52:38,315 - ETL - ERROR - Error loading data to database: 'NoneType' object has no attribute 'rollback'
2025-05-20 18:52:38,316 - ETL - ERROR - Traceback (most recent call last):
  File "C:\Users\adeda\onedrive\desktop\ecommerce_scraping\database.py", line 107, in insert_product
    cursor = conn.cursor()
             ^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'cursor'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\adeda\onedrive\desktop\ecommerce_scraping\etl.py", line 233, in load_to_database
    product_id = insert_product(conn, product_data)
  File "C:\Users\adeda\onedrive\desktop\ecommerce_scraping\database.py", line 159, in insert_product
    conn.rollback()
    ^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'rollback'

2025-05-20 18:52:38,317 - ETL - INFO - Establishing database connection
2025-05-20 18:52:38,317 - Database - ERROR - Error connecting to database: unable to open database file
2025-05-20 18:52:38,318 - Database - ERROR - Error inserting product: 'NoneType' object has no attribute 'cursor'
2025-05-20 18:52:38,318 - ETL - ERROR - Error loading data to database: 'NoneType' object has no attribute 'rollback'
2025-05-20 18:52:38,319 - ETL - ERROR - Traceback (most recent call last):
  File "C:\Users\adeda\onedrive\desktop\ecommerce_scraping\database.py", line 107, in insert_product
    cursor = conn.cursor()
             ^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'cursor'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\adeda\onedrive\desktop\ecommerce_scraping\etl.py", line 233, in load_to_database
    product_id = insert_product(conn, product_data)
  File "C:\Users\adeda\onedrive\desktop\ecommerce_scraping\database.py", line 159, in insert_product
    conn.rollback()
    ^^^^^^^^^^^^^
AttributeError: 'NoneType' object has no attribute 'rollback'

2025-05-20 18:52:38,320 - ETL - INFO - Processed 3 files from C:/Users/adeda/OneDrive/Desktop/Ecommerce_Scraping/data
2025-05-21 06:43:14,634 - ETL - INFO - No database connection provided, will establish when needed
2025-05-21 06:43:14,636 - ETL - INFO - Establishing database connection
2025-05-21 06:43:14,658 - Database - INFO - Database tables created successfully
2025-05-21 06:43:14,663 - Database - INFO - Product inserted successfully: Google Pixel 9 Pro - Unlocked Android Smartphone with Gemini, Triple Rear Camera System, 24-Hour Battery, and 6.3" Super Actua Display - Obsidian, 128GB
2025-05-21 06:43:14,668 - Database - INFO - Price inserted successfully for product ID: 1
2025-05-21 06:43:14,673 - Database - INFO - Review stats inserted successfully for product ID: 1
2025-05-21 06:43:14,674 - ETL - INFO - Successfully loaded product Google Pixel 9 Pro - Unlocked Android Smartphone with Gemini, Triple Rear Camera System, 24-Hour Battery, and 6.3" Super Actua Display - Obsidian, 128GB to database
2025-05-21 06:43:14,680 - Database - INFO - Product inserted successfully: Apple iPhone 16 Pro Max 256 GB: 5G Mobile phone with Apple Intelligence, Camera Control, A18 Pro Chip and a Huge Leap in Battery Life. Works with AirPods; Desert Titanium
2025-05-21 06:43:14,687 - Database - INFO - Price inserted successfully for product ID: 2
2025-05-21 06:43:14,693 - Database - INFO - Review stats inserted successfully for product ID: 2
2025-05-21 06:43:14,694 - ETL - INFO - Successfully loaded product Apple iPhone 16 Pro Max 256 GB: 5G Mobile phone with Apple Intelligence, Camera Control, A18 Pro Chip and a Huge Leap in Battery Life. Works with AirPods; Desert Titanium to database
2025-05-21 06:43:14,701 - Database - INFO - Product inserted successfully: Samsung Galaxy S25 Ultra AI Smartphone, 12GB Memory, 256GB Storage, S Pen Included, Titanium Black and Galaxy Watch Ultra Orange, 47mm, LTE (UK Version)
2025-05-21 06:43:14,706 - Database - INFO - Price inserted successfully for product ID: 3
2025-05-21 06:43:14,712 - Database - INFO - Review stats inserted successfully for product ID: 3
2025-05-21 06:43:14,713 - ETL - INFO - Successfully loaded product Samsung Galaxy S25 Ultra AI Smartphone, 12GB Memory, 256GB Storage, S Pen Included, Titanium Black and Galaxy Watch Ultra Orange, 47mm, LTE (UK Version) to database
2025-05-21 06:43:14,713 - ETL - INFO - Processed 3 files from C:/Users/adeda/OneDrive/Desktop/Ecommerce_Scraping/data
